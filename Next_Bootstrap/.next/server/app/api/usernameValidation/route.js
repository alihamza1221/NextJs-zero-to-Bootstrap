"use strict";(()=>{var e={};e.id=156,e.ids=[156],e.modules={11185:e=>{e.exports=require("mongoose")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},70855:(e,t,s)=>{s.r(t),s.d(t,{originalPathname:()=>h,patchFetch:()=>v,requestAsyncStorage:()=>p,routeModule:()=>m,serverHooks:()=>f,staticGenerationAsyncStorage:()=>g});var r={};s.r(r),s.d(r,{GET:()=>l});var a=s(49303),n=s(88716),i=s(60670),o=s(45256),u=s(93227),c=s(72344);let d=s(7410).z.object({username:c.$});async function l(e){try{let{searchParams:t}=new URL(e.url),s={username:t.get("username")},r=d.safeParse(s);if(!r.success)return Response.json({success:!1,message:r.error.format().username?._errors||[]},{status:400});{await (0,o.Z)();let{username:e}=r.data;if(await u.Z.findOne({username:e,isVerified:!0}))return Response.json({success:!1,message:"Username already exists"},{status:400})}}catch(e){return console.log(e.message),Response.json({success:!1,message:e.message},{status:500})}return Response.json({success:!0,message:"Username available"},{status:200})}let m=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/usernameValidation/route",pathname:"/api/usernameValidation",filename:"route",bundlePath:"app/api/usernameValidation/route"},resolvedPagePath:"C:\\Users\\aliha\\Desktop\\Nextjs\\NextJs-zero-to-Bootstrap\\Next_Bootstrap\\app\\api\\usernameValidation\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:p,staticGenerationAsyncStorage:g,serverHooks:f}=m,h="/api/usernameValidation/route";function v(){return(0,i.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:g})}},45256:(e,t,s)=>{s.d(t,{Z:()=>i});var r=s(11185),a=s.n(r);let n={};async function i(){if(n.isConnected)return console.log("using existing connection"),!0;try{let e=await a().connect(process.env.MONGODB_URI||"");return n.isConnected=e.connections[0].readyState,console.log("new connection: "+n.isConnected),1==n.isConnected||Error("DB connection failed")}catch(e){return console.log(e),!1}}},93227:(e,t,s)=>{s.d(t,{Z:()=>o});var r=s(11185),a=s.n(r);let n=new r.Schema({content:{type:String,required:[!0,"Pleas add some content!"]},createdAt:{type:Date,required:!0,default:Date.now}}),i=new r.Schema({email:{type:String,required:[!0,"Pleas add some content!"],unique:!0,trim:!0,lowercase:!0,match:[/^([\w-\.]+@([\w-]+\.)+[\w-]{2,4})?$/,"Please fill a valid email address"]},username:{type:String,required:!0,trim:!0,minlength:2},password:{type:String,required:[!0,"username can't be empty"],trim:!0,minlength:2},verificationCode:{type:String,required:[!0,"verification code is required"]},verificationCodeExpiration:{type:Date,required:[!0,"verification code expiry is required"]},isVerified:{type:Boolean,default:!1,required:!0},isAcceptingMessages:{type:Boolean,default:!0},messages:[n]}),o=a().models.User||a().model("User",i)},72344:(e,t,s)=>{s.d(t,{$:()=>a});var r=s(7410);let a=r.z.string().min(3,{message:"Username must be at least 3 characters long"}).max(20,{message:"Username must be at most 20 characters long"});r.z.object({username:a,email:r.z.string().email(),password:r.z.string().min(6,{message:"Password must be at least 6 characters long"})})}};var t=require("../../../webpack-runtime.js");t.C(e);var s=e=>t(t.s=e),r=t.X(0,[948,691],()=>s(70855));module.exports=r})();